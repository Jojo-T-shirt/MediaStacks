<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MediaStacks</title>
  <meta name="theme-color" content="#111111" />
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="icon" href="./icons/icon-192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="./icons/icon-192.png" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header class="topbar">
    <h1>MediaStacks</h1>
    <nav>
      <a href="#/">Accueil</a>
      <a href="#/catalogue">Catalogue</a>
      <a href="#/profil">Profil</a>
      <a href="#/communaute">Communauté</a>
    </nav>
    <button id="btnInstall" hidden>Installer l’app</button>
  </header>

  <main id="app" class="container">Chargement…</main>
  <div id="toast" class="toast" aria-live="polite" hidden></div>

  <script type="module" src="./src/app.js"></script>
  <script>
    let deferredPrompt;
    const btnInstall = document.getElementById('btnInstall');
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault(); deferredPrompt = e; btnInstall.hidden = false;
    });
    btnInstall.addEventListener('click', async () => {
      btnInstall.hidden = true;
      if (deferredPrompt) { deferredPrompt.prompt(); await deferredPrompt.userChoice; deferredPrompt = null; }
    });
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => navigator.serviceWorker.register('./service-worker.js'));
    }
  </script>
</body>
</html>
